<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Review Contact Request - HON</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
    }

    body {
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        background: #fafafa;
        overflow-x: hidden;
    }

    .bg-gradient {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        z-index: -1;
        overflow: hidden;
        background: #fafafa;
    }

    .gradient-orb {
        position: absolute;
        border-radius: 50%;
        filter: blur(100px);
        opacity: 0.1;
        animation: float 20s ease-in-out infinite;
    }

    .orb-1 {
        width: 600px;
        height: 600px;
        background: radial-gradient(circle, #F73B20, transparent);
        top: -10%;
        right: -10%;
        animation-duration: 25s;
    }

    .orb-2 {
        width: 500px;
        height: 500px;
        background: radial-gradient(circle, #ff5238, transparent);
        bottom: -15%;
        left: -10%;
        animation-duration: 20s;
        animation-delay: 2s;
    }

    @keyframes float {
        0%, 100% { transform: translate(0, 0) scale(1); }
        33% { transform: translate(50px, -80px) scale(1.1); }
        66% { transform: translate(-50px, 50px) scale(0.9); }
    }

    .header {
        background: white;
        box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        padding: 1rem 0;
        position: sticky;
        top: 0;
        z-index: 1000;
    }

    .header h1 {
        font-size: 1.75rem;
        font-weight: 700;
        color: #1a1a1a;
        margin: 0;
    }

    .user-avatar {
        width: 40px;
        height: 40px;
        border-radius: 50%;
        background: linear-gradient(135deg, #F73B20, #ff5238);
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-weight: 600;
    }

    .sidebar {
        background: white;
        box-shadow: 2px 0 10px rgba(0,0,0,0.05);
        min-height: calc(100vh - 76px);
        padding: 2rem 1rem;
    }

    .nav-item {
        margin-bottom: 0.5rem;
    }

    .nav-link {
        color: #4a5568;
        padding: 0.875rem 1.25rem;
        border-radius: 0.75rem;
        display: flex;
        align-items: center;
        gap: 0.75rem;
        font-weight: 500;
        transition: all 0.3s ease;
        text-decoration: none;
    }

    .nav-link i {
        font-size: 1.25rem;
        width: 24px;
    }

    .nav-link:hover {
        background: #f7f7f7;
        color: #F73B20;
    }

    .nav-link.active {
        background: linear-gradient(135deg, #F73B20, #ff5238);
        color: white;
        box-shadow: 0 4px 15px rgba(247, 59, 32, 0.3);
    }

    .main-content {
        padding: 2rem;
        min-height: calc(100vh - 76px);
    }

    .back-button {
        display: inline-flex;
        align-items: center;
        gap: 0.5rem;
        color: #6b7280;
        text-decoration: none;
        font-weight: 500;
        margin-bottom: 1.5rem;
        transition: all 0.3s ease;
    }

    .back-button:hover {
        color: #F73B20;
    }

    .review-container {
        max-width: 1200px;
        margin: 0 auto;
    }

    .detail-card {
        background: white;
        border-radius: 1rem;
        padding: 2rem;
        box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        border: 1px solid #f0f0f0;
        margin-bottom: 2rem;
    }

    .detail-header {
        display: flex;
        justify-content: between;
        align-items: start;
        margin-bottom: 2rem;
        padding-bottom: 1.5rem;
        border-bottom: 2px solid #f0f0f0;
        flex-wrap: wrap;
        gap: 1rem;
    }

    .detail-title {
        flex: 1;
    }

    .detail-title h2 {
        font-size: 1.75rem;
        font-weight: 700;
        color: #1a1a1a;
        margin-bottom: 0.5rem;
    }

    .detail-subtitle {
        color: #6b7280;
        font-size: 0.95rem;
    }

    .status-badge {
        padding: 0.75rem 1.5rem;
        border-radius: 2rem;
        font-size: 0.875rem;
        font-weight: 600;
        text-transform: uppercase;
    }

    .status-badge.open {
        background: #dbeafe;
        color: #1e40af;
    }

    .status-badge.in-progress {
        background: #fef3c7;
        color: #92400e;
    }

    .status-badge.resolved {
        background: #d1fae5;
        color: #065f46;
    }

    .info-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 1.5rem;
        margin-bottom: 2rem;
    }

    .info-item {
        display: flex;
        flex-direction: column;
        gap: 0.5rem;
    }

    .info-label {
        font-size: 0.875rem;
        font-weight: 600;
        color: #6b7280;
        text-transform: uppercase;
        letter-spacing: 0.5px;
    }

    .info-value {
        font-size: 1rem;
        color: #1a1a1a;
        font-weight: 500;
    }

    .info-value i {
        color: #F73B20;
        margin-right: 0.5rem;
    }

    .issue-section {
        background: #f9fafb;
        border-radius: 0.75rem;
        padding: 1.5rem;
        margin-bottom: 2rem;
    }

    .issue-type-badge {
        display: inline-block;
        padding: 0.5rem 1rem;
        background: white;
        border-radius: 0.5rem;
        font-size: 0.875rem;
        font-weight: 600;
        color: #374151;
        margin-bottom: 1rem;
        box-shadow: 0 1px 3px rgba(0,0,0,0.1);
    }

    .message-section {
        margin-bottom: 2rem;
    }

    .message-title {
        font-size: 1.1rem;
        font-weight: 600;
        color: #1a1a1a;
        margin-bottom: 1rem;
    }

    .message-content {
        background: white;
        border-left: 4px solid #F73B20;
        padding: 1.5rem;
        border-radius: 0.5rem;
        line-height: 1.7;
        color: #4a5568;
        box-shadow: 0 1px 3px rgba(0,0,0,0.05);
    }

    .action-section {
        background: white;
        border-radius: 1rem;
        padding: 2rem;
        box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        border: 1px solid #f0f0f0;
    }

    .action-title {
        font-size: 1.25rem;
        font-weight: 700;
        color: #1a1a1a;
        margin-bottom: 1.5rem;
    }

    .form-group {
        margin-bottom: 1.5rem;
    }

    .form-label {
        display: block;
        font-weight: 600;
        color: #374151;
        margin-bottom: 0.5rem;
    }

    .form-select {
        width: 100%;
        padding: 0.875rem;
        border: 2px solid #e5e7eb;
        border-radius: 0.5rem;
        font-size: 1rem;
        transition: all 0.3s ease;
    }

    .form-select:focus {
        outline: none;
        border-color: #F73B20;
        box-shadow: 0 0 0 3px rgba(247, 59, 32, 0.1);
    }

    .form-textarea {
        width: 100%;
        padding: 0.875rem;
        border: 2px solid #e5e7eb;
        border-radius: 0.5rem;
        font-size: 1rem;
        min-height: 150px;
        resize: vertical;
        font-family: inherit;
        transition: all 0.3s ease;
    }

    .form-textarea:focus {
        outline: none;
        border-color: #F73B20;
        box-shadow: 0 0 0 3px rgba(247, 59, 32, 0.1);
    }

    .action-buttons {
        display: flex;
        gap: 1rem;
        flex-wrap: wrap;
    }

    .btn-primary {
        padding: 1rem 2rem;
        border-radius: 0.5rem;
        background: linear-gradient(135deg, #F73B20, #ff5238);
        color: white;
        border: none;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        font-size: 1rem;
    }

    .btn-primary:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 15px rgba(247, 59, 32, 0.3);
    }

    .btn-secondary {
        padding: 1rem 2rem;
        border-radius: 0.5rem;
        background: #f3f4f6;
        color: #4a5568;
        border: none;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        font-size: 1rem;
    }

    .btn-secondary:hover {
        background: #e5e7eb;
    }

    .btn-danger {
        padding: 1rem 2rem;
        border-radius: 0.5rem;
        background: #dc2626;
        color: white;
        border: none;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        font-size: 1rem;
    }

    .btn-danger:hover {
        background: #b91c1c;
        transform: translateY(-2px);
    }

    .alert {
        padding: 1rem 1.5rem;
        border-radius: 0.5rem;
        margin-bottom: 1.5rem;
        display: none;
    }

    .alert.show {
        display: block;
    }

    .alert-success {
        background: #d1fae5;
        color: #065f46;
        border-left: 4px solid #10b981;
    }

    .alert-error {
        background: #fee2e2;
        color: #991b1b;
        border-left: 4px solid #dc2626;
    }

    @media (max-width: 767.98px) {
        .detail-header {
            flex-direction: column;
        }

        .info-grid {
            grid-template-columns: 1fr;
        }

        .action-buttons {
            flex-direction: column;
        }

        .action-buttons button {
            width: 100%;
        }
    }
  </style>
</head>
<body>
<div class="bg-gradient">
  <div class="gradient-orb orb-1"></div>
  <div class="gradient-orb orb-2"></div>
</div>

<header class="header">
  <div class="container-fluid">
    <div class="d-flex justify-content-between align-items-center">
      <div class="d-flex align-items-center gap-3">
        <button class="btn d-lg-none" type="button" data-bs-toggle="offcanvas" data-bs-target="#sidebar">
          <i class="fas fa-bars"></i>
        </button>
        <h1>HON Dashboard</h1>
      </div>
      <div class="user-avatar">A</div>
    </div>
  </div>
</header>

<div class="container-fluid">
  <div class="row">
    <div class="col-lg-3 col-xl-2 d-none d-lg-block p-0">
      <nav class="sidebar" style="position:sticky;top:70px;">
        <ul class="nav flex-column">
          <li class="nav-item">
            <a class="nav-link" href="/admin/dashboard">
              <i class="fas fa-chart-line"></i>
              <span>Dashboard</span>
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/admin/hon/users">
              <i class="fas fa-users"></i>
              <span>HON Users</span>
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/admin/badge/management">
              <i class="fas fa-award"></i>
              <span>Badges</span>
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/admin/reports">
              <i class="fas fa-file-alt"></i>
              <span>Report Section</span>
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/admin/virtual/gift">
              <i class="fas fa-gift"></i>
              <span>Virtual Gift</span>
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/admin/quiz/management">
              <i class="fas fa-question-circle"></i>
              <span>Quiz Management</span>
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link active" href="/admin/contact/requests">
              <i class="fas fa-envelope"></i>
              <span>Contact Admin</span>
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/admin/settings">
              <i class="fas fa-cog"></i>
              <span>Settings</span>
            </a>
          </li>
        </ul>
      </nav>
    </div>

    <div class="offcanvas offcanvas-start" tabindex="-1" id="sidebar">
      <div class="offcanvas-header">
        <h5 class="offcanvas-title">Menu</h5>
        <button type="button" class="btn-close" data-bs-dismiss="offcanvas"></button>
      </div>
      <div class="offcanvas-body p-0">
        <nav class="sidebar">
          <ul class="nav flex-column">
            <li class="nav-item">
              <a class="nav-link" href="/admin/dashboard">
                <i class="fas fa-chart-line"></i>
                <span>Dashboard</span>
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="/admin/hon/users">
                <i class="fas fa-users"></i>
                <span>HON Users</span>
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="/admin/badge/management">
                <i class="fas fa-award"></i>
                <span>Badges</span>
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="/admin/reports">
                <i class="fas fa-file-alt"></i>
                <span>Report Section</span>
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="/admin/virtual/gift">
                <i class="fas fa-gift"></i>
                <span>Virtual Gift</span>
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="/admin/quiz/management">
                <i class="fas fa-question-circle"></i>
                <span>Quiz Management</span>
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link active" href="/admin/contact/requests">
                <i class="fas fa-envelope"></i>
                <span>Contact Admin</span>
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="/admin/settings">
                <i class="fas fa-cog"></i>
                <span>Settings</span>
              </a>
            </li>
          </ul>
        </nav>
      </div>
    </div>

    <div class="col-lg-9 col-xl-10">
      <main class="main-content">
        <a href="/admin/contact/requests" class="back-button">
          <i class="fas fa-arrow-left"></i>
          Back to Requests
        </a>

        <div class="review-container">
          <div id="alertContainer"></div>

          <div class="detail-card">
            <div class="detail-header">
              <div class="detail-title">
                <h2>Contact Request Details</h2>
                <p class="detail-subtitle">Request ID: #<span th:text="${request.id}">12345</span></p>
              </div>
              <span class="status-badge" th:classappend="${request.status.toString().toLowerCase().replace('_', '-')}" 
                    th:text="${request.status}">
                OPEN
              </span>
            </div>

            <div class="info-grid">
              <div class="info-item">
                <span class="info-label">Full Name</span>
                <span class="info-value">
                  <i class="fas fa-user"></i>
                  <span th:text="${request.name}">John Doe</span>
                </span>
              </div>
              <div class="info-item">
                <span class="info-label">Username</span>
                <span class="info-value">
                  <i class="fas fa-at"></i>
                  <span th:text="${request.username}">@johndoe</span>
                </span>
              </div>
              <div class="info-item">
                <span class="info-label">Email Address</span>
                <span class="info-value">
                  <i class="fas fa-envelope"></i>
                  <span th:text="${request.email}">john@example.com</span>
                </span>
              </div>
              <div class="info-item">
                <span class="info-label">Submitted On</span>
                <span class="info-value">
                  <i class="fas fa-clock"></i>
                  <span th:text="${#temporals.format(request.createdAt, 'MMM dd, yyyy hh:mm a')}">Dec 20, 2024 10:30 AM</span>
                </span>
              </div>
            </div>

            <div class="issue-section">
              <div class="info-label" style="margin-bottom: 0.5rem;">Issue Category</div>
              <div class="issue-type-badge" th:text="${request.issueType}">
                Technical Issue
              </div>
            </div>

            <div class="message-section">
              <h3 class="message-title">Request Message</h3>
              <div class="message-content" th:text="${request.message}">
                I'm experiencing issues with my account login. Whenever I try to sign in, I get an error message saying "Invalid credentials" even though I'm sure my password is correct. I've tried resetting my password twice but the problem persists. 
                
                This has been happening for the past 3 days and I'm unable to access my account at all. I've also tried using different browsers (Chrome, Firefox, Safari) but the issue remains the same. 
                
                Could you please help me resolve this as soon as possible? I have important work pending in my account.
              </div>
            </div>
          </div>

          <div class="action-section">
            <h3 class="action-title">Take Action</h3>
            
            <form th:action="@{/admin/contact/update/{id}(id=${request.id})}" method="post">
              <div class="form-group">
                <label class="form-label" for="status">Update Status</label>
                <select class="form-select" id="status" name="status" th:field="${request.status}">
                  <option value="OPEN">Open</option>
                  <option value="IN_PROGRESS">In Progress</option>
                  <option value="RESOLVED">Resolved</option>
                </select>
              </div>

              <div class="form-group">
                <label class="form-label" for="adminNotes">Admin Notes / Response</label>
                <textarea class="form-textarea" id="adminNotes" name="adminNotes" 
                          placeholder="Add your notes or response to the user here..."></textarea>
              </div>

              <div class="action-buttons">
                <button type="submit" class="btn-primary">
                  <i class="fas fa-save"></i> Save Changes
                </button>
                <button type="button" class="btn-secondary" onclick="sendEmail()">
                  <i class="fas fa-paper-plane"></i> Send Email to User
                </button>
                <button type="button" class="btn-danger" onclick="deleteRequest()">
                  <i class="fas fa-trash"></i> Delete Request
                </button>
              </div>
            </form>
          </div>
        </div>
      </main>
    </div>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script>
  function showAlert(message, type) {
    const alertContainer = document.getElementById('alertContainer');
    const alertClass = type === 'success' ? 'alert-success' : 'alert-error';
    alertContainer.innerHTML = `
      <div class="alert ${alertClass} show">
        <i class="fas fa-${type === 'success' ? 'check-circle' : 'exclamation-circle'}"></i>
        ${message}
      </div>
    `;
    
    setTimeout(() => {
      alertContainer.innerHTML = '';
    }, 5000);
  }

  function sendEmail() {
    const email = document.querySelector('.info-value span[th\\:text="${request.email}"]')?.textContent || 'user';
    if (confirm(`Send email notification to ${email}?`)) {
      // Add AJAX call here to send email
      showAlert('Email sent successfully to the user!', 'success');
    }
  }

  function deleteRequest() {
    if (confirm('Are you sure you want to delete this request? This action cannot be undone.')) {
      // Add AJAX call here to delete request
      showAlert('Request deleted successfully!', 'success');
      setTimeout(() => {
        window.location.href = '/admin/contact/requests';
      }, 1500);
    }
  }

  // Form submission handler
  document.querySelector('form')?.addEventListener('submit', function(e) {
    e.preventDefault();
    // Add AJAX submission here
    showAlert('Request updated successfully!', 'success');
    setTimeout(() => {
      window.location.href = '/admin/contact/requests';
    }, 1500);
  });
</script>
</body>
</html>