<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>



<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.2/js/bootstrap.bundle.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels"></script>

<script th:inline="javascript">
    /*<![CDATA[*/
    const categoryData = /*[[${categoryPointsMap}]]*/ {};

    if (Object.keys(categoryData).length > 0) {
        const labels = Object.keys(categoryData);
        const data = Object.values(categoryData);

        const canvas = document.getElementById('pointsChart');
        if (canvas) {
            const ctx = canvas.getContext('2d');

            new Chart(ctx, {
                type: 'pie',
                data: {
                    labels: labels,
                    datasets: [{
                        label: "Today's Points",
                        data: data,
                        borderWidth: 1,
                        backgroundColor: [
                            '#3B82F6',
                            '#EF4444',
                            '#F59E0B',
                            '#FBBF24',
                            '#10B981',
                            '#8B5CF6',
                            '#9CA3AF'
                        ]
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: { display: false },
                        datalabels: {
                            color: '#fff',
                            font: { weight: 'bold', size: 14 },
                            formatter: (value, context) => {
                                const label = context.chart.data.labels[context.dataIndex];
                                return `${value} ${label}`;
                            }
                        }
                    }
                },
                plugins: [ChartDataLabels]
            });
        }
    }
    /*]]>*/
</script>
</body>
</html>